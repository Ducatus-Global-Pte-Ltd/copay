<ion-header>
  <ion-navbar>
    <ion-title>{{'Home' | translate}}</ion-title>
  </ion-navbar>
</ion-header>

<ion-content padding>
  <ion-card *ngIf="serverMessage">
    <ion-item>
      <div>{{serverMessage.title}}</div>
      <div>{{serverMessage.body}}</div>
      <div (click)="openServerMessageLink()">
        <span translate>Learn more</span>
      </div>
    </ion-item>
  </ion-card>

  <ion-card *ngIf="newRelease">
    <ion-icon>
      <img src="assets/img/icon-update.svg" class="bg" />
    </ion-icon>
    <ion-card-header>
      {{updateText}}
    </ion-card-header>
    <ion-card-content>
      <button ion-button (click)="goToDownload()">
        <span translate>Download</span>
      </button>
    </ion-card-content>
  </ion-card>

  <ion-card *ngIf="txps && txps[0]">
    <ion-item>
      <span translate>Payment Proposals</span>
      <ion-badge (click)="openProposalsPage()" *ngIf="txpsN>3" item-end>{{txpsN}}</ion-badge>
    </ion-item>

    <ion-list>
      <ion-item *ngFor="let tx of txps" (click)="openTxpModal(tx)">
        <page-txp [tx]="tx" [addressbook]="addressbook"></page-txp>
      </ion-item>
    </ion-list>
  </ion-card>

  <ion-card *ngIf="notifications && notifications[0] && recentTransactionsEnabled">
    <ion-item>
      <span translate>Recent Transactions</span>
      <ion-badge (click)="openActivityPage()" *ngIf="notificationsN>3" item-end>{{notificationsN}}</ion-badge>
    </ion-item>

    <ion-item *ngFor="let notification of notifications" (click)="openNotificationModal(notification)">
      <page-wallet-activity [notification]="notification"></page-wallet-activity>
    </ion-item>

  </ion-card>

  <div *ngIf="!wallets || !wallets[0]">
    <ion-card (click)="goToAddView()">
      <ion-item detail-push>
        <span translate>Create a new wallet</span>
      </ion-item>
    </ion-card>
  </div>

  <ion-card *ngIf="walletsBtc && walletsBtc[0]">
    <ion-item>
      <span translate>Bitcoin Wallets</span>
      <button ion-button clear item-end class="header-icon" (click)="goToAddView()">
        <ion-icon name="ios-add"></ion-icon>
      </button>
    </ion-item>

    <ion-list>
      <button ion-item *ngFor="let wallet of walletsBtc" (click)="goToWalletDetails(wallet)">
        <ion-icon item-start>
          <img *ngIf="wallet.network == 'testnet'" src="assets/img/icon-wallet-testnet.svg" class="icon-wallet" />
          <img *ngIf="wallet.network != 'testnet'" src="assets/img/icon-wallet.svg" class="icon-wallet" />
        </ion-icon>
        <h2>{{wallet.credentials.walletName}} <span *ngIf="wallet.credentials.m > 1">{{wallet.credentials.m}}-{{wallet.credentials.n}}</span></h2>
        <span *ngIf="wallet.scanning" translate>Scanning funds</span>        
        <p *ngIf="!wallet.scanning && !wallet.balanceHidden">{{wallet.status.availableBalanceSat || 0 | satToUnit}} {{cachedBalanceUpdateOn}}</p>
        <p *ngIf="wallet.balanceHidden">[{{'Balance Hidden' | translate}}]</p>
        <p *ngIf="wallet.error" class="error">{{wallet.error}}</p>
      </button>
    </ion-list>
  </ion-card>

  <ion-card *ngIf="walletsBch && walletsBch[0]">
    <ion-item>
      <span translate>Bitcoin Cash Wallets</span>
      <button ion-button clear item-end class="header-icon" (click)="goToAddView('bch')">
        <ion-icon name="ios-add"></ion-icon>
      </button>
    </ion-item>

    <ion-list>
      <button ion-item *ngFor="let wallet of walletsBch" (click)="goToWalletDetails(wallet)">
        <ion-icon item-start>
          <img src="assets/img/icon-wallet.svg" class="icon-wallet" />
        </ion-icon>
        <h2>{{wallet.credentials.walletName}} <span *ngIf="wallet.credentials.m > 1">{{wallet.credentials.m}}-{{wallet.credentials.n}}</span></h2>
        <span *ngIf="wallet.scanning" translate>Scanning funds</span>        
        <p *ngIf="!wallet.scanning">{{wallet.status.availableBalanceSat || 0 | satToUnit: wallet.coin}} {{cachedBalanceUpdateOn}}</p>
        <p *ngIf="wallet.error" class="error">{{wallet.error}}</p>
      </button>
    </ion-list>
  </ion-card>

</ion-content>